#!/bin/bash


#======================================================================================================================
# Run checks.
#======================================================================================================================

source ${BF_INC}/proxy-check.sh


#======================================================================================================================
# Require source files.
#======================================================================================================================

source ${BF_INC}/proxy-replace.sh
source ${BF_INC}/proxy-setup-nginx.sh
source ${BF_INC}/proxy-setup-ssl.sh


#======================================================================================================================
# Initialise Nginx and SSL for requested domain.
#======================================================================================================================

if [ "${1}" = "${PROXY_URI}" ] ; then

    bf-echo "Initialising Nginx and SSL for proxy server ${PROXY_URI}..." "proxy/init"
    init-proxy

else

    bf-echo "Initialising Nginx and SSL for ${1}..." "proxy/init"
    init-domain "${1}"

fi

bf-done "proxy/init"
