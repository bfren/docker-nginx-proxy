#!/usr/bin/with-contenv bash

#======================================================================================================================
# Ensure email is set
#======================================================================================================================

[[ -z "${LETS_ENCRYPT_EMAIL}" ]] && "LETS_ENCRYPT_EMAIL must be set before requesting SSL certificates."


#======================================================================================================================
# Create arrays and include configuration
#======================================================================================================================

SSL_CONF=${SSL}/conf.sh
[[ ! -f ${SSL_CONF} ]] && _error "You must create ${SSL_CONF} - see ssl-conf-sample.sh."

declare -A DOMAINS
declare -A ALIASES
declare -A NGXCONF

source ${SSL_CONF}


#======================================================================================================================
# Check whether or not domains have been registered
#======================================================================================================================

[[ "${#DOMAINS[@]}" = "0" ]] && _error "No domains have been registered for SSL."


#======================================================================================================================
# Ensure certs directory exists
#======================================================================================================================

[[ ! -d ${SSL_CERTS} ]] && mkdir ${SSL_CERTS}
